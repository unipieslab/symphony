#!/bin/bash

# Usage:
# Frequency values are: max (for high freq - 2.4GHz) and med (for medium freq  - 1.2GHz)
# Set max freq to all cores: ./setfreq max
# Set medium freq to all cores: ./setfreq med
# Set freq to certain cores: ./setfreq max 2 3

if [ $# -eq 1 ]; then
        start=0
        end=7;
elif [ $# -eq 3 ]; then
        start=$2
        end=$3;
else
        echo "You have to specify both at least 2 cores"
        exit 1;
fi;

for a in $(ls /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor);
do
        echo "userspace" > $a;
done;
for (( c=${start}; c<=${end}; c++ ));
do
        if [[ $1 == "max" ]]; then
                echo 2400000 > /sys/devices/system/cpu/cpu${c}/cpufreq/scaling_setspeed;
        elif [[ $1 == "min" ]]; then
                echo 300000 > /sys/devices/system/cpu/cpu${c}/cpufreq/scaling_setspeed;
        elif [[ $1 == "med" ]]; then
                echo 1200000 > /sys/devices/system/cpu/cpu${c}/cpufreq/scaling_setspeed;
        else
                echo $1 > /sys/devices/system/cpu/cpu${c}/cpufreq/scaling_setspeed;
	fi;
done;
sleep 1;
echo "You're ready to go..."
echo "Current frequency values are: "
./currfreq
